var tmpSQBArr=null;var tmpVitemArr=null;var tmpPrdMediaArr=null;tmpPrdMediaArr=[];tmpSQBArr=[];tmpVitemArr=[];var tmpVindex=0;currPgTitle=stxt[17];document.title=currPgTitle;var euiFFObjArr=null;var euiFFObjArr=[];ck_name=/^[A-Za-z0-9 ]{3,20}$/;ck_email=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;ck_username=/^[A-Za-z0-9_]{3,20}$/;ck_password=/^[A-Za-z0-9!@#$%^&*()_]{6,20}$/;ck_title=/^[A-Za-z0-9.\s]{3,120}$/;var doDelIRdir=function(e,d,f){document.location.href="index.html?pid=aa-edit-category&cid="+cid+"&catid="+catid+"&t="+JSSHOP.getUnixTimeStamp();};var doN=function(e,d,f){doItemEdit();};var doneImgInsrt=function(f,d,h){try{JSSHOP.shop.getPrdMedia(catid,itemid,"dadido");doAIU();}catch(g){alert(g);}};var finishImgInsrt=function(a){try{JSSHOP.shared.setFrmFieldVal("qmedia","m_file",a);JSSHOP.shared.setFrmFieldVal("qmedia","m_uid",quid);JSSHOP.shared.setFrmFieldVal("qmedia","m_coid",cid);JSSHOP.shared.setFrmFieldVal("qmedia","m_catid",catid);JSSHOP.shared.setFrmFieldVal("qmedia","m_pid",itemid);tmpDOs=null;tmpDOs={};tmpDOs["knvp"]=JSSHOP.shared.getFrmVals(document["qmedia"],"nada");oi=getNuDBFnvp("qmedia",6,null,tmpDOs);doQComm(oi["rq"],null,"doneImgInsrt");}catch(b){alert(b);}};var finishImgUload=function(a){try{finishImgInsrt(a);}catch(b){alert(b);}};var fnshProdMDel=function(a,b,c){JSSHOP.ui.closeLbox();JSSHOP.shop.getPrdMedia(catid,itemid,"dadido");};var doPrdMDelete=function(){if(confirm(stxt[42]+" "+stxt[19]+"?")){procNuUIitem("qmedia","m_rtype",JSSHOP.shared.getFrmFieldVal("qmedia","_id",0),"0","fnshProdMDel");}};var fnshCatChange=function(){document.getElementById("mod_i_catid").disabled=false;JSSHOP.ui.setCBBClickClr(tdSpin,"bkgdClrDlg","clsDummy",function(){void (0);});};var doCatChange=function(a){document.getElementById("mod_i_catid").disabled=true;objVal=JSSHOP.shared.getCurrSelectOpt(a);procNuUIitem("qitem","i_catid",itemid,objVal,"fnshCatChange");};var fnshProdMMain=function(a,b,c){JSSHOP.ui.closeLbox();showCurrImg();};var doPrdMMain=function(){if(confirm("Set as main product picture?"+JSSHOP.shared.getFrmFieldVal("qmedia","m_file",0))){JSSHOP.shared.setFrmFieldVal("qitem","i_img",JSSHOP.shared.getFrmFieldVal("qmedia","m_file",0));procNuUIitem("qitem","i_img",itemid,JSSHOP.shared.getFrmFieldVal("qmedia","m_file",0),"fnshProdMMain");}};var doQIMeta=function(){tmpMetaObj={};tmpMetaObj.qco=arrAllForms.qco.v[0];tmpMetaObj.qitem=JSSHOP.shop.getCurrItemArr();return JSON.stringify(tmpMetaObj);};var appFnshImgUload=function(a,b){try{document.getElementById("fldChallArray").value=a;tmpImg=document.getElementById("fldChallArray").value;finishImgInsrt(tmpImg);}catch(c){alert("appFnshImgUload: "+c);}};var doFUJSLoad=function(){ttbtn=document.getElementById("uploadBtn");if((isJApp!=="no")&&(isPhP=="no")){alert("japp-no-php");}else{JSSHOP.loadScript("js/sau.js",JSSHOP.checkLoader,"js");}};var showCurrImg=function(){tmpIvaval=i_img.value;if(tmpIvaval!=="noQvalue"){if(isPhP=="no"){tmpIstrI="data:image/png;base64, "+tmpIvaval;imgIedit.src=tmpIstrI;}else{if(tmpIvaval.indexOf(".")!=-1){tmpIstrI="images/pimgs/s_thumb"+tmpIvaval;imgIedit.src=tmpIstrI;}}}};var doItemEditPop=function(){loadJSModal("tplates/aa-mod-edit-item.html?tt="+JSSHOP.getUnixTimeStamp());};var doQIedit=function(a){tmpVindex=a;JSSHOP.shared.setFrmVals("qitem",tmpVitemArr[a],function(){doItemEditPop();});};var getQIstr=function(a,b){strTret="<div onclick=\"JSSHOP.ui.setCBBClickClr(this,'crsrPointer brdrClrHdr','crsrPointer brdrNone', function(){doQIedit("+a+');});" class="crsrPointer brdrNone txtBig">';strTret+=b+"</div>";return strTret;};var renderNuTQBItems=function(e,d,f){JSSHOP.ui.setCBBClickClr(dvWrapper,"cls_button cls_button-medium brdrClrDlg txtClrHdr","clsDummy",function(){void (0);});};var renderDBis=function(c,a,b){tmpVitemArr=null;tmpVitemArr=[];tmpVitemArr=JSON.parse(a);JSSHOP.shared.setFrmVals("qitem",tmpVitemArr[0],void (0));JSSHOP.shared.setDynFieldVals(tmpVitemArr[0],"mod_");if(tmpVitemArr[0].i_img){tmpIva=tmpVitemArr[0].i_img;if(tmpIva=="noQvalue"){}else{tImgstr="images/pimgs/"+tmpVitemArr[0].i_img;document.getElementById("imgIedit").src=tImgstr;}}};var preRenderTQBItems=function(e,d,f){tmpDOs=null;tmpDOs={};tmpDOs["ws"]="where _id=? and i_rtype=?";tmpDOs["wa"]=[itemid,"5"];oi=getNuDBFnvp("qitem",5,null,tmpDOs);doQComm(oi["rq"],null,"renderDBis");};var doCBcatedit=function(e,d,f){JSSHOP.ui.setCBBClickClr(mmn,"cls_button cls_button-medium brdrClrDlg txtClrHdr","nanimenu",function(){document.location.href=document.location.href+"&fc=y";});};var doCatTitleEdit=function(a){JSSHOP.shared.setFrmFieldVal("qcat","cat_dadded",JSSHOP.getUnixTimeStamp());tmpDOs=null;tmpDOs={};tmpDOs["ws"]="where _id=?";tmpDOs["wa"]=[a];tmpDOs["knvp"]=JSSHOP.shared.getKNVParr(JSSHOP.shared.getDynFrmVals(document["qcat"],"tmp_"));oi=getNuDBFnvp("qcat",7,null,tmpDOs);doQComm(oi["rq"],null,"doCBcatedit");};var doItemEdit=function(){JSSHOP.ui.closeLbox();JSSHOP.shared.setFrmFieldVal("qitem","i_dadded",JSSHOP.getUnixTimeStamp());tmpFobj=null;tmpFobj={};tmpFobj["knvp"]=JSSHOP.shared.getKNVParr(JSSHOP.shared.getDynFrmVals(document["qitem"],"mod_"));tmpFobj["ws"]="where _id=?";tmpFobj["wa"]=[itemid];oi=getNuDBFnvp("qitem",7,null,tmpFobj);if(JSSHOP.shared.valVOarr(euiFFObjArr,"dvVdtnError")){doQComm(oi["rq"],null,"renderNuTQBItems");}};var doItemAdd=function(a,b){JSSHOP.shared.setFrmFieldVal("qitem","i_desc","....");JSSHOP.shared.setFrmFieldVal("qitem","i_uid",quid);JSSHOP.shared.setFrmFieldVal("qitem","i_coid",cid);JSSHOP.shared.setFrmFieldVal("qitem","i_dadded",JSSHOP.getUnixTimeStamp());tmpFobj=null;tmpFobj={};tmpFobj["knvp"]=JSSHOP.shared.getKNVParr(JSSHOP.shared.getDynFrmVals(document["qitem"],"tmp_"));oi=getNuDBFnvp("qitem",6,null,tmpFobj);JSSHOP.ui.setCBBClickClr(divQitems,"cls_button cls_button-medium brdrClrDlg txtClrHdr","txtClrHdr bkgdClrWhite",function(){JSSHOP.ui.closeLbox();});doQComm(oi["rq"],null,"preRenderTQBItems");};var doItemDelete=function(c,a,b){carr=tmpVitemArr[a];narr=removeArrElement(tmpVitemArr,b);c.parentNode.parentNode.parentNode.deleteRow(b);tmpVitemArr=null;tmpVitemArr=narr;JSSHOP.ui.setCBBClickClr(divQitems,"cls_button cls_button-medium brdrClrDlg txtClrHdr","txtClrHdr bkgdClrWhite",function(){JSSHOP.ui.closeLbox();});JSSHOP.shared.setFrmFieldVal("qitem","i_dadded",JSSHOP.getUnixTimeStamp());JSSHOP.shared.setFrmFieldVal("qitem","i_rtype","0");tmpDOs=null;tmpDOs={};tmpDOs["ws"]="where _id=?";tmpDOs["wa"]=[a];tmpDOs["knvp"]=JSSHOP.shared.getFrmVals(document["qitem"],"nada");oi=getNuDBFnvp("qcartitem",7,null,tmpDOs);doQComm(oi["rq"],null,"renderNuTQBItems");};var doNuItemDelete=function(){if(confirm(stxt[42]+" "+stxt[19]+"?")){procNuUIitem("qitem","i_rtype",JSSHOP.shared.getFrmFieldVal("qitem","_id",0),"0","doDelIRdir");}};var getPrdImgEditDv=function(a){tpPIEDv=document.createElement("div");try{tsa=null;tsa={};tsa=tmpPrdMediaArr[a];if(tsa.m_file.indexOf(".mp4")!=-1){tmpRetStr='<video controls><source type="video/mp4" src="'+JSSHOP.shop.getPrdImgStr("prodpg",tsa.m_file)+'"></video>';}else{tmpRetStr='<img src="'+JSSHOP.shop.getPrdImgStr("prodpg",tsa.m_file)+'" style="width: 100%"  class="" onclick="alert(\''+JSSHOP.shared.getFrmFieldVal("qmedia","_id","0")+"');\">";}tmpRetStr+='<div class="dvTxtBtns"><input type="button" class="btnTxtLabel" value="Set as Main" onclick="javascript:doPrdMMain();">   |   <input type="button" class="btnTxtLabel" value="Delete" onclick="javascript:doPrdMDelete();"></div>';tmpRetStr+="<br><br>";tpPIEDv.innerHTML=tmpRetStr;return tpPIEDv;}catch(b){alert("getPrdImgEditDv "+b);tpPIEDv.innerHTML="oops. something wrong..";return tpPIEDv;}};var doPrdMIcnClick=function(a){ttta=tmpRPMArr[a];if(ttta.m_file.indexOf(".mp4")!=-1){JSSHOP.shared.setFrmVals("qmedia",tmpRPMArr[a],function(){app.getPlayMPF(ttta.m_file);});}else{JSSHOP.shared.setFrmVals("qmedia",tmpRPMArr[a],function(){JSSHOP.ui.popAndAppendLbox(getPrdImgEditDv(a),"y");});}};var dadido=function(b,c,d){try{if(c.indexOf("_id")!=-1){tmpRPMArr=null;tmpRPMArr=[];tmpRPMArr=JSON.parse(c);tmpPrdMediaArr=null;tmpPrdMediaArr=[];tmpPrdMediaArr=JSON.parse(c);tmmpII=0;tmpRetStr="<div>";tmpAlen=tmpPrdMediaArr.length;while(tmmpII<tmpAlen){tsa=tmpPrdMediaArr[tmmpII];tmpRetStr+='<img src="'+JSSHOP.shop.getPrdImgStr("prdmedia",tsa.m_file)+'" class="icnmnubtn crsrPointer" onclick="doPrdMIcnClick('+tmmpII+');">';tmmpII++;}tmpRetStr+="</div>";JSSHOP.ui.setTinnerHTML("dvPrdMedia","");JSSHOP.ui.setTinnerHTML("dvPrdMedia",tmpRetStr);}}catch(a){alert("rndrPrdMedia "+a);}};var doSubCOpts=function(){var a=theArr.length;var b=0;ts=null;tmpSlct=document.getElementById("mod_i_catid");while(b<a){ts=theArr[b];if(ts.cat_pid=="0"){}else{JSSHOP.shared.addOptAtVal(tmpSlct,ts.cat_pid,ts._id,ts.cat_title,"noQvalue");}b++;}JSSHOP.shared.setCurrSelectOpt(tmpSlct,catid);};var dmyFnishCntLoad=fnishCntLoad;fnishCntLoad=function(){doFUJSLoad();JSSHOP.shared.setDynFrmVals(document["qitem"],"mod_");showCurrImg();JSSHOP.shop.getPrdMedia(catid,itemid,"dadido");tfuh=nCurrFFieldOb();tfuh.fid="mod_i_title";tfuh.fdv=stxt[10];tfuh.fvr=ck_title;tfuh.fve=stxt[1004];tfuh.lid="lbl_i_title";tfuh.ltxt=stxt[10];euiFFObjArr.push(tfuh);tfid=nCurrFFieldOb();tfid.fid="mod_i_desc";tfid.fdv=stxt[40];tfid.fvr=ck_title;tfid.fve=stxt[1003];tfid.lid="lbl_i_desc";tfid.ltxt=stxt[40];euiFFObjArr.push(tfid);tfip=nCurrFFieldOb();tfip.fid="mod_i_price_b";tfip.fdv="0.99";tfip.fve=stxt[1003];tfip.lid="lbl_i_price_b";tfip.ltxt=stxt[18];euiFFObjArr.push(tfip);tfic=nCurrFFieldOb();tfic.fid="mod_i_catid";tfic.fdv=stxt[16];tfic.fve=stxt[1003];tfic.lid="lbl_i_catid";tfic.ltxt=stxt[16];euiFFObjArr.push(tfic);tfim=nCurrFFieldOb();tfim.fid="uploadBtn";tfim.lid="lbl_i_media";tfim.ltxt=stxt[55];euiFFObjArr.push(tfim);tfsb=nCurrFFieldOb();tfsb.fid="btnEUsave";tfsb.fty="button";tfsb.fcl=function(){doItemEdit();};euiFFObjArr.push(tfsb);JSSHOP.shared.initFrmComps(euiFFObjArr);JSSHOP.shared.removeOptions(document.getElementById("mod_i_catid"));tmpSlct=document.getElementById("mod_i_catid");JSSHOP.shared.addCurrSelectOpt(tmpSlct,"0","Top Main");var a=currMenuArr.length;var c=0;var b=0;tstr="";arrToOptFill=currMenuArr;while(c<a){ts=arrToOptFill[c];if(ts.cat_pid=="0"){JSSHOP.shared.addOptAtVal(tmpSlct,"noQvalue",ts._id,ts.cat_title,"txtClrWhite bkgdClrHdr");}c++;}setTimeout("doSubCOpts()",1000);};